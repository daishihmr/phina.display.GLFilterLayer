<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" content="width=device-width,height=device-height,user-scalable=no,initial-scale=1,maximum-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta charset="UTF-8">
</head>

<body>
  <canvas id="app"></canvas>
  <script src="https://rawgit.com/phinajs/phina.js/develop/build/phina.js"></script>
  <!-- <script src="https://rawgit.com/daishihmr/phigl.js/develop/build/phigl.js"></script> -->
  <script src="../../phigl.js/build/phigl.js"></script>
  <script src="../build/phina.glfilter.js"></script>
  <script>
  phina.globalize();

  phina.main(() => {
    const app = GameApp({
      // domElement: document.querySelector("#app"),
      backgroundColor: "black",
      startLabel: "main",
      width: 1500,
      height: 850,
      // fit: false,
      assets: {
        image: {
          "bg": "bg.jpg",
          "logo": "cureyell.png",
        },
      },
    }).run();

    app.enableStats();
  });

  phina.define("MainScene", {
    superClass: "DisplayScene",

    init: function() {
      this.superInit({
        width: 1500,
        height: 850,
      });

      const bgLayer = GLFilterLayer({
        width: 1500,
        height: 850,
        originX: 0,
        originY: 0,
        x: 0,
        y: 0,
        quarity: 1 / 2,
      }).addChildTo(this);

      const de = DisplayElement().addChildTo(this);
      const fgLayer = GLFilterLayer({
        width: 1500,
        height: 850,
        originX: 0,
        originY: 0,
        x: 0,
        y: 0,
        quarity: 1 / 2,
      }).addChildTo(de);

      const bg = Sprite("bg")
        .setPosition(this.gridX.center(), this.gridY.center())
        .addChildTo(bgLayer);
      const logo = Sprite("logo")
        .setPosition(this.gridX.span(8), this.gridY.center())
        .addChildTo(fgLayer);

      fgLayer.alpha = 0.5;

      // const gaussian = MultiGaussianNode().addTo(bgLayer);
      // this.on("enterframe", (e) => {
      //   gaussian.unit = Math.abs(Math.sin(e.app.frame * 0.02) * 3/4);
      // });
      // const zoomBlur = ZoomBlurNode();
      // zoomBlur.x = 0.5;
      // zoomBlur.y = 0.5;
      // zoomBlur.strength = 20;
      // zoomBlur.addTo(fgLayer);
      // this.on("enterframe", (e) => {
      //   zoomBlur.strength = Math.abs(Math.sin(e.app.frame * 0.07) * 20);
      // });

      this.tweener
        .wait(500)
        .call(() => {
          bgLayer.enableGL = !bgLayer.enableGL;
          fgLayer.enableGL = !fgLayer.enableGL;
        })
        .setLoop(true);

    },
  });
  </script>
</body>

</html>